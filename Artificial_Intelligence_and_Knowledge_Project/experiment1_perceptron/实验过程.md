首先读取文件,然后构建感知机,超平面的方程式为:$w^T \cdot x_0 + b$

计算超平面时,我们需要用到的参数有$w,x,\eta$,以及维度$dimension$和数据集$T$

我们需要设置初始的$w$,$b$和$\eta$,本次实验中$w_0 = (0,0),b_0 = 0,\eta = 0.01$,因此设计函数:

```python
def perceptron(T: list, eta: float, dimension: int) -> list:
```

其中,T为训练集,eta为$\eta$,dimension为维度,函数最终返回一个list,其中$list[0]$为最终的$w$,$list[1]$为最终的$b$



遍历数据集$T$中的每一个点$(x_i,y_i)$,若$y_i(w^T \cdot x_i + b) \leq 0$,则更新$w$和$b$的值,因此设计函数用于更新$w$和$b$的值:

```python
def update(w: list, b: float, eta: float, point: list, y: int, dimension: int) -> list:
```

其中$w$为训练集,$b$为更新前的$b$,eta为$\eta$,point为当前点的坐标,y为当前的点的$y_i$,dimension为维度,最终返回一个list,其中$list[0]$为更新后的$w$,$list[1]$为更新后的$b$



遍历代码并且更新$w$和$b$的代码为

```python
for i in T:
    if float(i[-1]) * (matrix_mult(i[0:2], w, dimension) + b) <= 0:
    temp_list: list = update(w, b, eta, i[0:2], i[-1], dimension)
    w = temp_list[0]
    b = temp_list[1]
```

其中$matrix\_mult$的作用是进行两个矩阵$w^T$和$x_i$的乘法并且返回结果



由于每一次遍历数据集,更新$w$和$b$的值后,我们还需要遍历整个数据集,来判断是否数据集中的每一组数据都不是误分类点.因此我们需要在函数$perceptron$中加入一个变量$label$来判断是否所有数都不是误分类点



对于本次实验,最终结果如下:

基于数据集$T$中前$75\%$的数据,最终得到的结果如下:

![](D:\Programming\AI\实验1 感知机\result.png)

考虑到Python中float精度问题,$w$最终应为$[0.045,-0.085]$,b应为$[-0.01]$,超平面为$0.045x^{(1)}-0.085x^{(2)}-0.01$

对于后$25\%$的数据进行测试,正确率为$75\%$
